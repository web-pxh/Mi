<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>小米商城</title>
  <link rel="stylesheet" href="./css/normalize.css">
  <link rel="stylesheet" href="./css/index.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon">
</head>

<body>
  <!-- 头部 -->
  <header id="header"></header>
  <!-- 分类 -->
  <div class="category">
    <div class="container">
      <!-- 分类上部分 -->
      <div class="swiper-slide">
        <!-- 分类详情 -->
        <div class="slide">
          <ul>
            <li>
              <a href="#">
                手机 电话卡
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">
                电视 盒子
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">
                笔记本 显示器
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">
                家电 插线板
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">
                出行 穿戴
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">
                智能 路由器
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">
                电源 配件
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">健康 儿童</a>
              <em></em>
            </li>
            <li>
              <a href="#">
                耳机 音箱
              </a>
              <em></em>
            </li>
            <li>
              <a href="#">生活 箱包</a>
              <em></em>
            </li>
          </ul>
        </div>
        <!-- 隐藏的内容 -->
        <div class="children">

        </div>
        <!-- 轮播图 -->
        <div class="swiper">
          <ul class="list" id="list">
            <!-- 轮播图片 -->
            <li class="on"><a href="#" target="_blank"><img src=""></a></li>
            <li><a href="#" target="_blank"><img src=""></a></li>
            <li><a href="#" target="_blank"><img src=""></a></li>
            <li><a href="#" target="_blank"><img src=""></a></li>
            <li><a href="#" target="_blank"><img src=""></a></li>
          </ul>
          <!-- 左右按钮 -->
          <a class="btn prev" style="left: 15rem;">&lt;</a>
          <a class="btn next">&gt;</a>
          <!-- 分页器 -->
          <ol class="page">
            <li class="on"></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ol>
        </div>
      </div>
      <!-- 分类下部分 -->
      <div class="sub">
        <div class="span">
          <ul>
            <li><a href="#"><img src="./img/xmms.png"><span>小米秒杀</span></a></li>
            <li><a href="#"><img src="./img/qytg.png"><span>企业团购</span></a></li>
            <li><a href="#"><img src="./img/fmtd.png"><span>F码通道</span></a></li>
            <li><a href="#"><img src="./img/mfk.png"><span>米粉卡</span></a></li>
            <li><a href="#"><img src="./img/yjhx.png"><span>以旧换新</span></a></li>
            <li><a href="#"><img src="./img/hfcz.png"><span>话费充值</span></a></li>
          </ul>
        </div>
        <div class="span1">
          <ul>
            <li><a href="./mi_details.html" target="_blank"><img src="./img/pic4.jpg"></a></li>
            <li><a href="./mi_details.html" target="_blank"><img src="./img/pic2.jpg"></a></li>
            <li><a href="./mi_details.html" target="_blank"><img src="./img/pic3.jpg"></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- 主要内容 -->
  <div class="main">
    <div class="container">
      <!-- 闪购 -->
      <div class="main-box1">
        <!-- 标题 -->
        <div class="title" id="xmsg">
          <h2>小米闪购</h2>
        </div>
        <!-- 内容 -->
        <div class="row">
          <!-- 倒计时 -->
          <div class="countdown">
            <span class="round" id="hour"></span>
            <img src="./img/shandian.png">
            <span class="desc">距离结束还有</span>
            <div class="time">
              <span>00</span>
              <i>:</i>
              <span id="min"></span>
              <i>:</i>
              <span id="second"></span>
            </div>
          </div>
          <!-- 列表 -->
          <div class="list" id="slide_list">
            <ul style="left: 0;">
              <li>
                <a href="#">
                  <div class="content">
                    <img src="./img/pic5.webp">
                    <h3>小米笔记本Air 12.5" 2019款 8代M3 4G 128G</h3>
                    <p class="desc">像杂志一样随身携带</p>
                    <p>
                      <span>3299元</span>
                      <del style="color:#b0b0b0">3599元</del>
                    </p>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <div class="content">
                    <img src="./img/pic5.webp">
                    <h3>小米笔记本Air 12.5" 2019款 8代M3 4G 128G</h3>
                    <p class="desc">像杂志一样随身携带</p>
                    <p>
                      <span>3299元</span>
                      <del style="color:#b0b0b0">3599元</del>
                    </p>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <div class="content">
                    <img src="./img/pic5.webp">
                    <h3>小米笔记本Air 12.5" 2019款 8代M3 4G 128G</h3>
                    <p class="desc">像杂志一样随身携带</p>
                    <p>
                      <span>3299元</span>
                      <del style="color:#b0b0b0">3599元</del>
                    </p>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <div class="content">
                    <img src="./img/pic5.webp">
                    <h3>小米笔记本Air 12.5" 2019款 8代M3 4G 128G</h3>
                    <p class="desc">像杂志一样随身携带</p>
                    <p>
                      <span>3299元</span>
                      <del style="color:#b0b0b0">3599元</del>
                    </p>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <div class="content">
                    <img src="./img/pic5.webp">
                    <h3>小米笔记本Air 12.5" 2019款 8代M3 4G 128G</h3>
                    <p class="desc">像杂志一样随身携带</p>
                    <p>
                      <span>3299元</span>
                      <del style="color:#b0b0b0">3599元</del>
                    </p>
                  </div>
                </a>
              </li>
            </ul>
          </div>
        </div>
        <!-- 左右切换 -->
        <div class="btn">
          <button id="left">&lt;</button>
          <!-- </span> -->
          <button id="right">&gt;</button>
          <!-- </span> -->
        </div>
      </div>
      <!-- 手机 -->
      <div class="main-box2">
        <!-- 标题 -->
        <div class="title">
          <h2>手机</h2>
          <!-- 查看全部 -->
          <div class="more">
            <a href="#">
              查看全部
              <span>
                <i>&gt;</i>
              </span>
            </a>
          </div>
        </div>
        <!-- 内容 -->
        <div class="row">
          <!-- 展示图 -->
          <div>
            <img src="./img/pic6.webp">
          </div>
          <!-- 列表 -->
          <div class="item">
            <ul>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- 家电 -->
      <div class="main-box3">
        <!-- 标题 -->
        <div class="title">
          <h2>家电</h2>
          <!-- tab切换 -->
          <div class="tab">
            <a href="#">
              <span class="act">热门</span>
              <span>电视影音</span>
            </a>
          </div>
        </div>
        <!-- 内容 -->
        <div class="row">
          <!-- 展示图 -->
          <div style="width:15rem;">
            <img
              src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/f256b81e4233333692eece77ed06ebc2.jpg?thumb=1&w=234&h=300&f=webp&q=90">
            <img
              src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/f256b81e4233333692eece77ed06ebc2.jpg?thumb=1&w=234&h=300&f=webp&q=90">
          </div>
          <!-- 列表 -->
          <div class="item">
            <ul>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- 智能 -->
      <div class="main-box4">
        <!-- 标题 -->
        <div class="title">
          <h2>智能</h2>
          <!-- tab切换 -->
          <div class="tab">
            <a href="#">
              <span class="act">热门</span>
              <span>安防</span>
              <span>出行</span>
            </a>
          </div>
        </div>
        <!-- 内容 -->
        <div class="row">
          <!-- 展示图 -->
          <div style="width:15rem;">
            <img
              src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/45c23f5b9a927b2dc49c25277e07727c.jpg?thumb=1&w=234&h=300&f=webp&q=90">
            <img
              src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/45c23f5b9a927b2dc49c25277e07727c.jpg?thumb=1&w=234&h=300&f=webp&q=90">
          </div>
          <!-- 列表 -->
          <div class="item">
            <ul>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- 搭配 -->
      <div class="main-box5">
        <!-- 标题 -->
        <div class="title">
          <h2>搭配</h2>
          <!-- tab切换 -->
          <div class="tab">
            <a href="#">
              <span class="act">热门</span>
              <span>耳机音箱</span>
            </a>
          </div>
        </div>
        <!-- 内容 -->
        <div class="row">
          <!-- 展示图 -->
          <div style="width:15rem;">
            <img
              src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/6874615b3c50e837ffe532eb6ea4ef1a.jpg?thumb=1&w=234&h=300&f=webp&q=90">
            <img
              src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/6874615b3c50e837ffe532eb6ea4ef1a.jpg?thumb=1&w=234&h=300&f=webp&q=90">
          </div>
          <!-- 列表 -->
          <div class="item">
            <ul>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- 配件-->
      <div class="main-box6">
        <!-- 标题 -->
        <div class="title">
          <h2>配件</h2>
          <!-- tab切换 -->
          <div class="tab">
            <a href="#">
              <span class="act">热门</span>
              <span>充电器</span>
            </a>
          </div>
        </div>
        <!-- 内容 -->
        <div class="row">
          <!-- 展示图 -->
          <div style="width:15rem;">
            <img
              src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/9f64bbd58c3f5001bdf0688894f22cb6.jpg?thumb=1&w=234&h=300&f=webp&q=90">
            <img
              src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/9f64bbd58c3f5001bdf0688894f22cb6.jpg?thumb=1&w=234&h=300&f=webp&q=90">
          </div>
          <!-- 列表 -->
          <div class="item">
            <ul>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- 周边-->
      <div class="main-box7">
        <!-- 标题 -->
        <div class="title">
          <h2>周边</h2>
          <!-- tab切换 -->
          <div class="tab">
            <a href="#">
              <span class="act">热门</span>
              <span>出行</span>
            </a>
          </div>
        </div>
        <!-- 内容 -->
        <div class="row">
          <!-- 展示图 -->
          <div style="width:15rem;">
            <img
              src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/ca0940f052227d235e7de5678d106c89.jpg?thumb=1&w=234&h=300&f=webp&q=90">
            <img
              src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/ca0940f052227d235e7de5678d106c89.jpg?thumb=1&w=234&h=300&f=webp&q=90">
          </div>
          <!-- 列表 -->
          <div class="item">
            <ul>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- 视频 -->
      <div class="main-box8">
        <!-- 标题 -->
        <div class="title">
          <h2>视频</h2>
          <!-- 查看全部 -->
          <div class="more">
            <a href="javascript:">
              查看全部
              <span>
                <i>&gt;</i>
              </span>
            </a>
          </div>
        </div>
        <!-- 内容 -->
        <div class="video">
          <ul>
            <li>
              <a href="javascript:">
                <div class="v-img">
                  <img
                    src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/101b19aca4bb489bcef0f503e44ec866.jpg?thumb=1&w=296&h=180&f=webp&q=90">
                  <span class="play">
                    <div></div>
                  </span>
                </div>
                <h3>Redmi 10X系列发布会</h3>
                <p>Redmi 10X系列发布会</p>
              </a>
            </li>
            <li>
              <a href="javascript:">
                <div class="v-img">
                  <img
                    src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/101b19aca4bb489bcef0f503e44ec866.jpg?thumb=1&w=296&h=180&f=webp&q=90">
                  <span class="play">
                    <div></div>
                  </span>
                </div>
                <h3>Redmi 10X系列发布会</h3>
                <p>Redmi 10X系列发布会</p>
              </a>
            </li>
            <li>
              <a href="javascript:">
                <div class="v-img">
                  <img
                    src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/101b19aca4bb489bcef0f503e44ec866.jpg?thumb=1&w=296&h=180&f=webp&q=90">
                  <span class="play">
                    <div></div>
                  </span>
                </div>
                <h3>Redmi 10X系列发布会</h3>
                <p>Redmi 10X系列发布会</p>
              </a>
            </li>
            <li>
              <a href="javascript:">
                <div class="v-img">
                  <img
                    src="http://cdn.cnbj1.fds.api.mi-img.com/mi-mall/101b19aca4bb489bcef0f503e44ec866.jpg?thumb=1&w=296&h=180&f=webp&q=90">
                  <span class="play">
                    <div></div>
                  </span>
                </div>
                <h3>Redmi 10X系列发布会</h3>
                <p>Redmi 10X系列发布会</p>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- 左侧楼层滚动 -->
  <div class="left_nav">
    <ul>
      <li style="width: 32px;">小米闪购</li>
      <li>手机</li>
      <li>家电</li>
      <li>智能</li>
      <li>搭配</li>
      <li>配件</li>
      <li>周边</li>
      <li>视频</li>
    </ul>
  </div>
  <!-- 右侧的导航栏 -->
  <nav id="bar"></nav>
  <!-- 底部 -->
  <footer id="footer"></footer>

  
  <!-- 引入工具类 -->
  <script src="./js/jquery.min.js"></script>
  <script src="./js/request.js"></script>
  <script src="./js/utils.js"></script>
  <script src="./js/components.js"></script>
  <script>
    window.onload = function () {
      /* 用户名 */
      // var search = window.location.search;
      // var iframe = document.querySelector(".iframe_header").contentWindow;
      // var login = iframe.document.getElementById("login");
      // if (search) {
      //   login.innerHTML = search.slice(1);
      //   login.href = "#";
      // }
      /* 倒计时 */
      hour.innerHTML = countDown().hour + ':00 场';
      min.innerHTML = countDown().min;
      setInterval(() => {
        second.innerHTML = countDown().second;
        //判断秒是否等于0
        if (countDown().second == 0) {
          min.innerHTML = countDown().min;
          // location.reload();
        }
        //判断分钟是否等于0
        if (countDown().min == 0 && countDown().second == 0) {
          hour.innerHTML = countDown().hour + ':00 场';
          // location.reload();
        }
      }, 100);


      /* 闪购滑动效果 */
      /* 获取ul */
      var slide_listul = document.querySelector("#slide_list ul");
      /*  获取li的个数*/
      var liLength = document.querySelectorAll("#slide_list ul li").length;
      /* 获取ul的宽度 */
      var ulwidth = document.querySelector("#slide_list ul").offsetWidth + 21;
      /* 获取左右按钮 */
      var right = document.getElementById("right");
      var left = document.getElementById("left");
      /* 判断ul的left值是否等于0 */
      if (parseInt(slide_listul.style.left) == 0) {
        /* 给左按钮添加disabled属性 */
        left.setAttribute('disabled', true);
      }
      /* 如果li个数只有4个,添加disabled */
      if (liLength == 4) {
        /* 给右按钮添加disabled属性 */
        right.setAttribute('disabled', true);
      }
      /* 点击事件 */
      right.onclick = function () {
        rClick(liLength, slide_listul, ulwidth, right, left);
      }
      left.onclick = function () {
        lClick(slide_listul, ulwidth, right, left);
      }

      /* 楼层滚动 */
      /* 获取主要内容这个大的div */
      var box = document.querySelector('.main .container');
      /* 获取.main .container下所有的子元素*/
      var lous = box.children; //楼层
      /* 获取整个左侧导航栏 */
      var leftNav = document.querySelector('.left_nav');
      /* 获取ul下所有的li */
      var btns = leftNav.querySelectorAll('ul li'); //按钮

      //1.点击按钮可以跳转到对应楼层
      for (var i = 0; i < btns.length; i++) {
        //绑定索引
        btns[i].index = i;
        btns[i].onclick = function () {
          // console.log(this.index);
          //排他
          for (var j = 0; j < btns.length; j++) {
            btns[j].className = '';
          }
          this.className = 'on';
          var ih = lous[this.index].offsetTop;
          window.scrollTo(0, ih);
        }

      }

      //2.滚动滑轮，到达临界点的时候，按钮跟着高亮显示
      window.onscroll = function () {
        var scrollTop = window.scrollY; //滚动距离
        for (var i = 0; i < lous.length; i++) {
          if (scrollTop >= lous[i].offsetTop) {
            //排他 设置高亮
            for (var j = 0; j < btns.length; j++) {
              btns[j].className = '';
            }
            btns[i].className = 'on';
          }
        }
        /* 左侧导航栏位置 */
        if (xmsg.getBoundingClientRect().top < 100) {
          leftNav.style.position = "fixed";
          leftNav.style.top = 50 + 'px';
        } else if (xmsg.getBoundingClientRect().top > 40) {
          leftNav.style.position = "absolute";
          leftNav.style.top = 850 + 'px';
          btns[0].className = '';
        }
        /* 右侧导航栏回到顶部 */
        if (scrollTop > 1000) {
          toTop.style.visibility = "visible";
        } else {
          toTop.style.visibility = "hidden";
        }
      }

      /* 请求首页商品数据 */
      /* 获取main下li */
      var phonelis = document.querySelectorAll(".main-box2 .item li");
      var houeslis = document.querySelectorAll(".main-box3 .item li");
      var intelligencelis = document.querySelectorAll(".main-box4 .item li");
      var collocationlis = document.querySelectorAll(".main-box5 .item li");
      var partslis = document.querySelectorAll(".main-box6 .item li");
      var peripherylis = document.querySelectorAll(".main-box7 .item li");

      /* 发送请求 */
      ajax("get", `/Mi/index/list`, isListShow);

      /* 回调函数 */
      function isListShow(result) {
        if (result.length > 0) {
          var info = JSON.parse(result);
          /* 手机 */
          var phone = info[0];
          /* 家电 */
          var houes = info[1];
          /* 智能 */
          var intelligence = info[2];
          /* 搭配 */
          var collocation = info[3];
          /* 配件 */
          var parts = info[4];
          /*  周边*/
          var periphery = info[5];

          getData(phone, phonelis);
          getData(houes, houeslis);
          getData(intelligence, intelligencelis);
          getData(collocation, collocationlis);
          getData(parts, partslis);
          getData(periphery, peripherylis);
        }
      };
    };
  </script>
  <script>
    /* 实现轮播功能 */
    //1.找到对应的DOM节点
    var box = document.querySelector(".swiper"); //找到容器盒子
    var list = document.querySelector("#list");
    var listli = document.querySelectorAll("#list li");
    //获取list li下的所有轮播图片
    var allImg = document.querySelectorAll("#list li img");
    var len = document.querySelectorAll(".page li").length;
    var ltBtn = document.querySelector(".prev");
    var rtBtn = document.querySelector(".next");
    var page = document.querySelector(".page");
    var pageli = document.querySelectorAll(".page li");
    /* 用来保存请求的图片 */
    var pics;
    //2.当前所处的下标
    var curIndex = 0;
    //3.左按钮点击事件
    ltBtn.onclick = function () {
      curIndex--;
      if (curIndex <= -1) {
        curIndex = len - 1;
      }
      //当前下标相同的显示,也就是添加上on,其他的去掉on
      for (var i = 0; i < listli.length; i++) {
        listli[i].classList.remove("on");
      }
      listli[curIndex].classList.add("on");
      // 处理下标对应
      for (var j = 0; j < pageli.length; j++) {
        pageli[j].classList.remove("on");
      }
      pageli[curIndex].classList.add("on");
    };
    // 4.右按钮点击事件
    rtBtn.onclick = function () {
      curIndex++;
      if (curIndex >= len) {
        curIndex = 0;
      }
      // 当前下标相同的显示,也就添加on,其他的去掉on
      for (var i = 0; i < listli.length; i++) {
        listli[i].classList.remove("on");
      }
      listli[curIndex].classList.add("on");
      // 处理下标对应
      for (var j = 0; j < pageli.length; j++) {
        pageli[j].classList.remove("on");
      }
      pageli[curIndex].classList.add("on");
    };
    //5.分页下标点击事件
    for (var i = 0; i < pageli.length; i++) {
      pageli[i].setAttribute("data-index", i); //ol下的li全部添加了data-index属性,意思就是给每个li加上了属于自己的序号
      pageli[i].onclick = function () {
        // console.log(this.getAttribute("data-index"));
        curIndex = this.getAttribute("data-index");
        for (var i = 0; i < listli.length; i++) {
          listli[i].classList.remove("on");
        }
        listli[curIndex].classList.add("on");
        // 处理下标对应
        for (var j = 0; j < pageli.length; j++) {
          pageli[j].classList.remove("on");
        }
        pageli[curIndex].classList.add("on");
      };
    }
    //6.自动播放
    var timer = setInterval(function () {
      rtBtn.onclick();
    }, 3000);
    //7.鼠标移入定时器停,移除,定时器开启
    box.onmouseenter = function () {
      clearInterval(timer);
    };
    box.onmouseleave = function () {
      timer = setInterval(function () {
        rtBtn.onclick();
      }, 3000);
    };


    /* 获取轮播图片 */
    /* 调用ajax函数 */
    ajax("get", `/Mi/swiper`, issuccess);
    /* 回调函数 */
    function issuccess(result) {
      if (result.length > 0) {
        pics = JSON.parse(result);
      } else {
        console.log("加载失败");
      }
      for (var i = 0; i < allImg.length; i++) {
        allImg[i].src = pics[i].img
        allImg[i].parentElement.href = pics[i].href
      }
    };
  </script>
</body>

</html>